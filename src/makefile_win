
all: iemmatrix.dll



CC = cl
LD = link

VIS_CPP_PATH = "C:\Programme\Microsoft Visual Studio\Vc98"

PD_INST_PATH = C:\Programme\pd

PD_WIN_INCLUDE_PATH = /I. /I"$(PD_INST_PATH)\src"

PD_WIN_C_FLAGS = /nologo /W3 /WX /DPD /D__WIN32__ /Ox -DPA_LITTLE_ENDIAN

PD_WIN_L_FLAGS = /nologo

PD_WIN_LIB = /NODEFAULTLIB:libc /NODEFAULTLIB:oldnames /NODEFAULTLIB:kernel /NODEFAULTLIB:uuid \
	libc.lib \
	/LIBPATH:$(PD_INST_PATH)\bin pd.lib


SRC = $(sort $(filter %.c, $(wildcard *.c)))


OBJ = $(SRC:.c=.obj)

$(OBJ): %.obj : %.c
	$(CC) $(PD_WIN_C_FLAGS) $(PD_WIN_INCLUDE_PATH) /c $*.c

iemmatrix.dll: $(OBJ)
	$(LD) $(PD_WIN_L_FLAGS) /dll /export:iemmatrix_setup \
	/out:iemmatrix.dll $(OBJ) $(PD_WIN_LIB)

clean:
	del *.obj
