#N canvas 316 110 645 684 10;
#N canvas 492 104 545 558 ~ 0;
#X obj 363 208 array define \$0.orig~;
#X obj 363 240 array define \$0.re~;
#X obj 363 260 array define \$0.im~;
#X msg 74 160 set \$1 \, bang;
#X obj 74 184 switch~;
#X obj 62 312 bang~;
#N canvas 735 461 450 300 DSP? 0;
#X obj 83 102 inlet;
#X obj 83 125 spigot;
#X obj 83 148 outlet;
#X obj 134 113 r pd;
#X obj 134 136 route dsp;
#X text 86 64 only calculate if DSP is on...;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 3 0 4 0;
#X connect 4 0 1 1;
#X restore 74 110 pd DSP?;
#X text 75 25 calculate the rFFT using Pd's built-in [rfft~] object;
#X text 74 50 (this patch only works if DSP is *on*);
#X obj 62 462 mtx;
#X obj 62 364 t l l;
#X obj 89 388 list length;
#X msg 89 411 1 \$1;
#X obj 89 434 mtx_zeros;
#X obj 194 78 inlet mtx.im;
#X obj 74 80 inlet mtx.re;
#X obj 112 212 tabreceive~ \$0.re~;
#X obj 232 212 tabreceive~ \$0.im~;
#X obj 112 235 rifft~;
#X obj 112 258 tabsend~ \$0.orig~;
#X obj 62 342 array get \$0.orig~;
#X obj 62 485 outlet orig;
#N canvas 204 229 450 300 mtx2table+resize 0;
#X obj 54 93 list split 3;
#X obj 54 32 t a a;
#X obj 94 32 mtx_size;
#X obj 88 119 list split 16;
#X obj 88 146 t l l;
#X obj 221 76 array size \$0.orig~;
#X obj 88 197 list length;
#X obj 54 9 inlet;
#X obj 88 280 outlet;
#X obj 261 187 array size \$0.re~;
#X obj 261 207 array size \$0.im~;
#X obj 236 156 t f f;
#X obj 163 76 t f f f;
#X obj 221 31 - 1;
#X obj 221 54 << 1;
#X obj 115 170 array set \$0.im~;
#X obj 88 230 - 1;
#X obj 88 253 << 1;
#X connect 0 1 3 0;
#X connect 1 0 0 0;
#X connect 1 1 2 0;
#X connect 2 1 12 0;
#X connect 3 0 4 0;
#X connect 4 0 6 0;
#X connect 4 1 15 0;
#X connect 6 0 16 0;
#X connect 7 0 1 0;
#X connect 11 0 10 0;
#X connect 11 1 9 0;
#X connect 12 0 3 1;
#X connect 12 1 11 0;
#X connect 12 2 13 0;
#X connect 13 0 14 0;
#X connect 14 0 5 0;
#X connect 16 0 17 0;
#X connect 17 0 8 0;
#X restore 194 139 pd mtx2table+resize;
#N canvas 204 229 450 300 mtx2table+resize 0;
#X obj 54 93 list split 3;
#X obj 54 32 t a a;
#X obj 94 32 mtx_size;
#X obj 88 119 list split 16;
#X obj 88 146 t l l;
#X obj 221 76 array size \$0.orig~;
#X obj 88 197 list length;
#X obj 54 9 inlet;
#X obj 88 265 outlet;
#X obj 261 187 array size \$0.re~;
#X obj 261 207 array size \$0.im~;
#X obj 236 156 t f f;
#X obj 163 76 t f f f;
#X obj 221 31 - 1;
#X obj 221 54 << 1;
#X obj 115 170 array set \$0.re~;
#X obj 88 220 - 1;
#X obj 88 243 << 1;
#X connect 0 1 3 0;
#X connect 1 0 0 0;
#X connect 1 1 2 0;
#X connect 2 1 12 0;
#X connect 3 0 4 0;
#X connect 4 0 6 0;
#X connect 4 1 15 0;
#X connect 6 0 16 0;
#X connect 7 0 1 0;
#X connect 11 0 10 0;
#X connect 11 1 9 0;
#X connect 12 0 3 1;
#X connect 12 1 11 0;
#X connect 12 2 13 0;
#X connect 13 0 14 0;
#X connect 14 0 5 0;
#X connect 16 0 17 0;
#X connect 17 0 8 0;
#X restore 74 139 pd mtx2table+resize;
#X connect 3 0 4 0;
#X connect 5 0 20 0;
#X connect 6 0 23 0;
#X connect 9 0 21 0;
#X connect 10 0 9 0;
#X connect 10 1 11 0;
#X connect 11 0 12 0;
#X connect 12 0 13 0;
#X connect 13 0 9 1;
#X connect 14 0 22 0;
#X connect 15 0 6 0;
#X connect 16 0 18 0;
#X connect 17 0 18 1;
#X connect 18 0 19 0;
#X connect 20 0 10 0;
#X connect 23 0 3 0;
#X restore 49 380 pd ~;
#X obj 49 358 t a a, f 9;
#X obj 90 8 inlet bang;
#N canvas 735 461 450 300 DSP 0;
#X obj 57 28 inlet post;
#X obj 186 26 inlet pre;
#X obj 328 70 r pd-dsp-started;
#X obj 330 130 r pd-dsp-stopped;
#X msg 328 95 1;
#X msg 330 155 0;
#X obj 218 109 i;
#X obj 57 136 i;
#X obj 57 53 t b;
#X msg 57 161 dsp \$1;
#X obj 57 186 s pd;
#X obj 186 51 t b b;
#X msg 186 76 1;
#X connect 0 0 8 0;
#X connect 1 0 11 0;
#X connect 2 0 4 0;
#X connect 3 0 5 0;
#X connect 4 0 6 1;
#X connect 5 0 6 1;
#X connect 6 0 7 1;
#X connect 7 0 9 0;
#X connect 8 0 7 0;
#X connect 9 0 10 0;
#X connect 11 0 12 0;
#X connect 11 1 6 0;
#X connect 12 0 9 0;
#X restore 133 100 pd DSP;
#X msg 159 8 bang;
#X floatatom 159 45 5 0 0 0 - - - 0;
#X obj 49 466 mtx_-;
#X obj 49 489 mtx_abs;
#X obj 49 512 mtx_< 1e-07;
#X obj 49 538 mtx_isequal 1;
#X obj 49 624 outlet 1==OK;
#X text 279 372 this uses Pd's DSP \, and therefore the result is one tick late!;
#X obj 90 70 t b f b b, f 24;
#X text 284 607 wait for the result;
#X obj 49 593 t a a;
#X msg 231 604 -1000;
#X obj 100 380 mtx_rifft, f 19;
#X obj 160 358 t a a, f 9;
#X obj 160 248 mtx_zeros 1 9;
#X obj 49 248 mtx_eye 1 9;
#X obj 49 271 mtx_roll 1;
#X obj 49 294 mtx_* 8;
#X obj 49 224 t a a;
#X obj 88 423 mtx_* 16;
#X floatatom 507 90 5 0 0 0 - - - 0;
#X obj 507 142 pow;
#X floatatom 507 165 5 0 0 0 - - - 0;
#X msg 507 112 2 \$1;
#X obj 39 68 int;
#X msg 39 91 2 \$1;
#X obj 39 114 pow;
#X msg 90 31 7;
#X msg 51 202 1 \$1;
#X obj 39 177 + 1;
#X floatatom 120 587 5 0 0 0 - - - 0;
#X obj 39 146 t f f;
#X obj 133 150 * 2;
#X connect 0 0 6 0;
#X connect 1 0 0 0;
#X connect 1 1 16 0;
#X connect 2 0 31 0;
#X connect 4 0 5 0;
#X connect 5 0 12 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 8 0 9 0;
#X connect 9 0 14 0;
#X connect 12 0 3 0;
#X connect 12 1 28 0;
#X connect 12 2 3 1;
#X connect 12 3 15 0;
#X connect 14 0 10 0;
#X connect 14 1 34 0;
#X connect 15 0 14 0;
#X connect 16 0 23 0;
#X connect 17 0 0 1;
#X connect 17 1 16 1;
#X connect 18 0 17 0;
#X connect 19 0 20 0;
#X connect 20 0 21 0;
#X connect 21 0 1 0;
#X connect 22 0 19 0;
#X connect 22 1 18 0;
#X connect 23 0 6 1;
#X connect 24 0 27 0;
#X connect 25 0 26 0;
#X connect 27 0 25 0;
#X connect 28 0 29 0;
#X connect 29 0 30 0;
#X connect 30 0 35 0;
#X connect 31 0 12 0;
#X connect 32 0 22 0;
#X connect 33 0 32 0;
#X connect 35 0 33 0;
#X connect 35 1 36 0;
#X connect 36 0 23 1;
